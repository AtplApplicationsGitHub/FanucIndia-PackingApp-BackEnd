{"version":3,"sources":["../../../src/modules/erp-material-importer/erp-material-importer.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Post,\r\n  UploadedFile,\r\n  UseInterceptors,\r\n  UseGuards,\r\n  BadRequestException,\r\n  Body,\r\n} from '@nestjs/common';\r\nimport { FileInterceptor } from '@nestjs/platform-express';\r\nimport { ErpMaterialImporterService } from './erp-material-importer.service';\r\nimport { JwtAuthGuard } from '../auth/jwt-auth.guard';\r\nimport { Roles } from '../auth/roles.decorator';\r\nimport {\r\n  ApiTags,\r\n  ApiBearerAuth,\r\n  ApiOperation,\r\n  ApiConsumes,\r\n  ApiBody,\r\n} from '@nestjs/swagger';\r\n\r\n@ApiTags('ERP Material Importer')\r\n@ApiBearerAuth()\r\n@UseGuards(JwtAuthGuard)\r\n@Controller('erp-material-importer')\r\nexport class ErpMaterialImporterController {\r\n  constructor(private readonly service: ErpMaterialImporterService) {}\r\n\r\n  @Post('upload')\r\n  @Roles('ADMIN','USER')\r\n  @UseInterceptors(FileInterceptor('file'))\r\n  @ApiOperation({ summary: 'Upload and process an ERP material file' })\r\n  @ApiConsumes('multipart/form-data')\r\n  @ApiBody({\r\n    schema: {\r\n      type: 'object',\r\n      properties: {\r\n        file: {\r\n          type: 'string',\r\n          format: 'binary',\r\n        },\r\n        saleOrderNumber: {\r\n          type: 'string',\r\n          description: 'The expected Sale Order Number to validate against the file content.',\r\n          nullable: true,\r\n        }\r\n      },\r\n    },\r\n  })\r\n  async uploadFile(@UploadedFile() file: Express.Multer.File, @Body('saleOrderNumber') saleOrderNumber?: string) {\r\n    if (!file) {\r\n      throw new BadRequestException('No file uploaded.');\r\n    }\r\n    return this.service.processFile(file, saleOrderNumber);\r\n  }\r\n}"],"names":["ErpMaterialImporterController","uploadFile","file","saleOrderNumber","BadRequestException","service","processFile","summary","schema","type","properties","format","description","nullable"],"mappings":";;;;+BAyBaA;;;eAAAA;;;wBAjBN;iCACyB;4CACW;8BACd;gCACP;yBAOf;;;;;;;;;;;;;;;AAMA,IAAA,AAAMA,gCAAN,MAAMA;IAGX,MAqBMC,WAAW,AAAgBC,IAAyB,EAAE,AAAyBC,eAAwB,EAAE;QAC7G,IAAI,CAACD,MAAM;YACT,MAAM,IAAIE,2BAAmB,CAAC;QAChC;QACA,OAAO,IAAI,CAACC,OAAO,CAACC,WAAW,CAACJ,MAAMC;IACxC;IA5BA,YAAY,AAAiBE,OAAmC,CAAE;aAArCA,UAAAA;IAAsC;AA6BrE;;;;;;QAxBkBE,SAAS;;;;QAGvBC,QAAQ;YACNC,MAAM;YACNC,YAAY;gBACVR,MAAM;oBACJO,MAAM;oBACNE,QAAQ;gBACV;gBACAR,iBAAiB;oBACfM,MAAM;oBACNG,aAAa;oBACbC,UAAU;gBACZ;YACF;QACF;;;;;;yDAE6C,yCAAA,OAAO,wCAAP,OAAO"}